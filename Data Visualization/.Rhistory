# ============================================
main_df <- read.table("C:/Users/sheld/OneDrive/Desktop/Sem 5/Data Science Programming/Lab/marketing_campaign.csv",
sep = "\t", header = TRUE)
main_df <- data.frame(main_df)
cat("Data loaded. Rows:", nrow(main_df), "\n")
cat("Columns:", ncol(main_df), "\n\n")
# ============================================
# DATA CLEANING
# ============================================
# Handle missing income values
if (any(is.na(main_df$Income))) {
main_df$Income[is.na(main_df$Income)] <- median(main_df$Income, na.rm = TRUE)
}
# Calculate age from Year_Birth
main_df$Age <- 2024 - main_df$Year_Birth
# Calculate total spending
main_df$Total_Spent <- main_df$MntWines + main_df$MntFruits +
main_df$MntMeatProducts + main_df$MntFishProducts +
main_df$MntSweetProducts + main_df$MntGoldProds
cat("Data cleaned successfully\n\n")
# ============================================
# VISUALIZATION 1: Income Distribution (Histogram)
# ============================================
# Simplest visualization - just income histogram
ggplot(main_df, aes(x = Income)) +
geom_histogram(fill = "steelblue", color = "black", bins = 30) +
labs(title = "Customer Income Distribution",
x = "Annual Income",
y = "Number of Customers") +
theme_minimal() +
theme(plot.title = element_text(face = "bold"))
# ============================================
# VISUALIZATION 2: Income vs Total Spending
# ============================================
# Easiest relationship plot - scatter with trend
ggplot(main_df, aes(x = Income, y = Total_Spent)) +
geom_point(color = "darkgreen", size = 2, alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Income vs Total Customer Spending",
x = "Annual Income",
y = "Total Amount Spent",
subtitle = "Linear trend line shown in red") +
theme_minimal() +
theme(plot.title = element_text(face = "bold"))
# ============================================
# SUMMARY STATISTICS
# ============================================
cat("\n========== CUSTOMER INSIGHTS ==========\n\n")
cat("Income Statistics:\n")
cat("  Mean:", round(mean(main_df$Income, na.rm = TRUE), 2), "\n")
cat("  Median:", round(median(main_df$Income, na.rm = TRUE), 2), "\n")
cat("  Min:", round(min(main_df$Income, na.rm = TRUE), 2), "\n")
cat("  Max:", round(max(main_df$Income, na.rm = TRUE), 2), "\n\n")
cat("Total Spending Statistics:\n")
cat("  Mean:", round(mean(main_df$Total_Spent, na.rm = TRUE), 2), "\n")
cat("  Median:", round(median(main_df$Total_Spent, na.rm = TRUE), 2), "\n")
cat("  Min:", round(min(main_df$Total_Spent, na.rm = TRUE), 2), "\n")
cat("  Max:", round(max(main_df$Total_Spent, na.rm = TRUE), 2), "\n\n")
# Calculate correlation
correlation <- cor(main_df$Income, main_df$Total_Spent, use = "complete.obs")
cat("Correlation (Income vs Total Spent):", round(correlation, 4), "\n\n")
# ============================================
# CUSTOMER SEGMENTS BY SPENDING
# ============================================
cat("Customer Segments by Spending:\n")
main_df$Segment <- ifelse(main_df$Total_Spent < quantile(main_df$Total_Spent, 0.33), "Low Spender",
ifelse(main_df$Total_Spent < quantile(main_df$Total_Spent, 0.67), "Medium Spender",
"High Spender"))
segment_summary <- table(main_df$Segment)
for (segment in names(segment_summary)) {
cat(segment, ":", segment_summary[segment], "customers\n")
}
cat("\n========== ANALYSIS COMPLETE ==========\n")
itemFrequencyPlot(tr, topN = 10, type = "absolute",
main = "Top 10 Most Frequently Purchased Items")
# Install packages if not already installed
if (!require(arules)) install.packages("arules")
if (!require(arulesViz)) install.packages("arulesViz")
if (!require(ggplot2)) install.packages("ggplot2")
if (!require(plyr)) install.packages("plyr")
if (!require(RColorBrewer)) install.packages("RColorBrewer")
if (!require(dplyr)) install.packages("dplyr")
if (!require(data.table)) install.packages("data.table")
# Load libraries
library(arules)
library(arulesViz)
library(ggplot2)
library(plyr)
library(dplyr)
library(RColorBrewer)
library(data.table)
# Read the data
superstore <- read.csv("C:/Users/sheld/OneDrive/Desktop/Sem 5/Data Science Programming/Lab/SampleSuperstore.csv")
# Data cleaning
superstore <- na.omit(superstore)
superstore <- superstore[superstore$Quantity > 0, ]
superstore <- superstore[superstore$Sales > 0, ]
# Create BasketID for market basket analysis
superstore <- superstore %>%
arrange(State, Segment) %>%
mutate(BasketID = data.table::rleid(State, Segment))
# ============================================
# VISUALIZATION 1: Sales by Category
# ============================================
ggplot(data = superstore, aes(x = Category, y = Sales, fill = Category)) +
geom_bar(stat = "identity", color = "black") +
labs(title = "Total Sales by Category",
x = "Category",
y = "Total Sales") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5))
# ============================================
# MARKET BASKET ANALYSIS
# ============================================
# Create transaction data
transactionData <- ddply(superstore, c("BasketID"),
function(df1) paste(df1$Sub.Category, collapse = ","))
transactionData$BasketID <- NULL
colnames(transactionData) <- c("items")
# Write and read transaction data
write.csv(transactionData, "C:/Users/sheld/OneDrive/Desktop/Sem 5/Data Science Programming/Lab/market_basket_transactions.csv",
quote = FALSE, row.names = FALSE)
tr <- read.transactions('C:/Users/sheld/OneDrive/Desktop/Sem 5/Data Science Programming/Lab/market_basket_transactions.csv',
format = 'basket', sep = ',')
# ============================================
# VISUALIZATION 2: Item Frequency Plot
# ============================================
itemFrequencyPlot(tr, topN = 10, type = "absolute",
main = "Top 10 Most Frequently Purchased Items")
# ============================================
# ASSOCIATION RULES
# ============================================
association.rules <- apriori(tr, parameter = list(supp = 0.001, conf = 0.5, maxlen = 10))
summary(association.rules)
cat("\n======== MARKET BASKET ANALYSIS COMPLETE ========\n")
# Install packages if not already installed
if (!require(arules)) install.packages("arules")
if (!require(arulesViz)) install.packages("arulesViz")
if (!require(ggplot2)) install.packages("ggplot2")
if (!require(plyr)) install.packages("plyr")
if (!require(RColorBrewer)) install.packages("RColorBrewer")
if (!require(dplyr)) install.packages("dplyr")
if (!require(data.table)) install.packages("data.table")
# Load libraries
library(arules)
library(arulesViz)
library(ggplot2)
library(plyr)
library(dplyr)
library(RColorBrewer)
library(data.table)
# Read the data
superstore <- read.csv("C:/Users/sheld/OneDrive/Desktop/Sem 5/Data Science Programming/Lab/SampleSuperstore.csv")
# Data cleaning
superstore <- na.omit(superstore)
superstore <- superstore[superstore$Quantity > 0, ]
superstore <- superstore[superstore$Sales > 0, ]
# Create BasketID for market basket analysis
superstore <- superstore %>%
arrange(State, Segment) %>%
mutate(BasketID = data.table::rleid(State, Segment))
# ============================================
# VISUALIZATION 1: Sales by Category
# ============================================
ggplot(data = superstore, aes(x = Category, y = Sales, fill = Category)) +
geom_bar(stat = "identity", color = "black") +
labs(title = "Total Sales by Category",
x = "Category",
y = "Total Sales") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5))
# ============================================
# MARKET BASKET ANALYSIS
# ============================================
# Create transaction data
transactionData <- ddply(superstore, c("BasketID"),
function(df1) paste(df1$Sub.Category, collapse = ","))
transactionData$BasketID <- NULL
colnames(transactionData) <- c("items")
# Write and read transaction data
write.csv(transactionData, "C:/Users/sheld/OneDrive/Desktop/Sem 5/Data Science Programming/Lab/market_basket_transactions.csv",
quote = FALSE, row.names = FALSE)
tr <- read.transactions('C:/Users/sheld/OneDrive/Desktop/Sem 5/Data Science Programming/Lab/market_basket_transactions.csv',
format = 'basket', sep = ',')
# ============================================
# VISUALIZATION 2: Item Frequency Plot
# ============================================
itemFrequencyPlot(tr, topN = 10, type = "absolute",
col = brewer.pal(8, "Pastel2"),
main = "Top 10 Most Frequently Purchased Items")
# ============================================
# ASSOCIATION RULES
# ============================================
association.rules <- apriori(tr, parameter = list(supp = 0.001, conf = 0.5, maxlen = 10))
summary(association.rules)
cat("\n======== MARKET BASKET ANALYSIS COMPLETE ========\n")
# ============================================
# MOVIE RECOMMENDATION SYSTEM - FINAL VERSION
# ============================================
# Load required libraries
if (!require(recommenderlab)) install.packages("recommenderlab")
if (!require(ggplot2)) install.packages("ggplot2")
if (!require(dplyr)) install.packages("dplyr")
if (!require(reshape2)) install.packages("reshape2")
library(recommenderlab)
library(ggplot2)
library(dplyr)
library(reshape2)
cat("Loading data...\n")
# ============================================
# LOAD DATA - USING STANDARD FILE PATH
# ============================================
movie_data <- read.csv("C:/Users/sheld/OneDrive/Desktop/Sem 5/Data Science Programming/Lab/movies.csv",
stringsAsFactors = FALSE)
rating_data <- read.csv("C:/Users/sheld/OneDrive/Desktop/Sem 5/Data Science Programming/Lab/ratings.csv")
cat("Movies loaded:", nrow(movie_data), "\n")
cat("Ratings loaded:", nrow(rating_data), "\n\n")
# ============================================
# VISUALIZATION 1: Rating Distribution
# ============================================
ggplot(rating_data, aes(x = rating)) +
geom_histogram(fill = "steelblue", color = "black", bins = 30) +
labs(title = "Rating Distribution",
x = "Rating (0.5 - 5.0)",
y = "Frequency") +
theme_minimal()
# ============================================
# VISUALIZATION 2: Top 10 Rated Movies
# ============================================
# Calculate average rating and count by movieId using base R
movie_stats <- data.frame(
movieId = unique(rating_data$movieId),
avg_rating = 0,
count = 0
)
for (i in 1:nrow(movie_stats)) {
movie_id <- movie_stats$movieId[i]
ratings <- rating_data$rating[rating_data$movieId == movie_id]
movie_stats$avg_rating[i] <- mean(ratings, na.rm = TRUE)
movie_stats$count[i] <- length(ratings)
}
# Filter movies with more than 50 ratings
top_rated <- movie_stats[movie_stats$count > 50, ]
top_rated <- top_rated[order(top_rated$avg_rating, decreasing = TRUE), ]
top_rated <- head(top_rated, 10)
# Merge with movie titles
top_rated <- merge(top_rated, movie_data, by = "movieId")
# Create bar plot
ggplot(top_rated, aes(x = reorder(title, avg_rating), y = avg_rating, fill = title)) +
geom_bar(stat = "identity", color = "black") +
coord_flip() +
labs(title = "Top 10 Rated Movies (min 50 ratings)",
x = "Movie Title",
y = "Average Rating") +
theme_minimal() +
theme(legend.position = "none")
# ============================================
# BUILD RECOMMENDATION SYSTEM
# ============================================
cat("\nBuilding recommendation system...\n")
# Create rating matrix (userId x movieId)
ratingMatrix <- dcast(rating_data, userId ~ movieId,
value.var = "rating", fill = NA)
ratingMatrix <- as.matrix(ratingMatrix[, -1])
ratingMatrix <- as(ratingMatrix, "realRatingMatrix")
cat("Rating matrix created:",
dim(ratingMatrix)[1], "users x",
dim(ratingMatrix)[2], "movies\n")
# ============================================
# TRAIN RECOMMENDATION MODEL
# ============================================
# Build Item-Based Collaborative Filtering (IBCF) model
recommend_model <- Recommender(data = ratingMatrix,
method = "IBCF",
parameter = list(k = 30))
cat("IBCF model trained successfully\n\n")
# ============================================
# MAKE PREDICTIONS
# ============================================
# Split data: 80% training, 20% testing
set.seed(123)
sampled_data <- sample(x = c(TRUE, FALSE),
size = nrow(ratingMatrix),
replace = TRUE,
prob = c(0.8, 0.2))
training_data <- ratingMatrix[sampled_data, ]
testing_data <- ratingMatrix[!sampled_data, ]
cat("Training set size:", nrow(training_data), "users\n")
cat("Testing set size:", nrow(testing_data), "users\n\n")
# Train model on full training data
recommend_model <- Recommender(data = training_data,
method = "IBCF",
parameter = list(k = 30))
# Get top 10 recommendations for each test user
top_recommendations <- 10
predicted_recommendations <- predict(object = recommend_model,
newdata = testing_data,
n = top_recommendations)
# ============================================
# DISPLAY RECOMMENDATIONS FOR FIRST TEST USER
# ============================================
cat("========== MOVIE RECOMMENDATIONS FOR FIRST TEST USER ==========\n\n")
user1_recommendations <- predicted_recommendations@items[[1]]
user1_movies <- predicted_recommendations@itemLabels[user1_recommendations]
user1_movie_titles <- sapply(user1_movies, function(x) {
subset(movie_data, movieId == x)$title
})
cat("Top", length(user1_movie_titles), "Recommended Movies:\n")
for (i in seq_along(user1_movie_titles)) {
cat(i, ".", user1_movie_titles[i], "\n")
}
# ============================================
# MODEL EVALUATION
# ============================================
cat("\n========== MODEL EVALUATION ==========\n\n")
# Create evaluation scheme
scheme <- evaluationScheme(ratingMatrix,
method = "split",
train = 0.8,
given = 15,
goodRating = 4)
# Build model using evaluation scheme
eval_model <- Recommender(getData(scheme, "train"),
method = "IBCF",
parameter = list(k = 30))
# Make predictions
pred <- predict(eval_model,
getData(scheme, "known"),
type = "ratings")
# Calculate accuracy
error <- calcPredictionAccuracy(pred, getData(scheme, "unknown"))
cat("Prediction Accuracy Metrics:\n")
cat("RMSE (Root Mean Squared Error):", round(error[1], 4), "\n")
cat("MAE (Mean Absolute Error):", round(error[2], 4), "\n")
cat("MSE (Mean Squared Error):", round(error[3], 4), "\n")
cat("\n========== ANALYSIS COMPLETE ==========\n")
library(shiny); runApp('C:/Users/sheld/OneDrive/Desktop/Sem 5/Data Science Programming/Material/Module - 4/electricityConsumptionMod7.R')
library(shiny); runApp('C:/Users/sheld/OneDrive/Desktop/Sem 5/Data Science Programming/Material/Module - 4/electricityConsumptionMod7.R')
list[["b"]]
list<- list(a=1,b=c(2,3,4),c="R")
list[["b"]]
shiny::runApp('D:/Data/Github/Sheldon/Data Visualization/Dashboard')
setwd("D:/Data/Github/Sheldon/Data Visualization")
length(c(1:24))
sort(c(1,5,8,6,0,5,2,1,4,9,5,3,8,2,6,7,15))
table(c("a","b","a","c","b","a","a","c","b"))
unique(c(1,2,2,3,4,4,5,5,6,7,7,8,9,9))
rev(c(1:20))
data<- iris
dim(data)
colnames(data)
rownames(data)
summary(data)
x<- c(1,2,3)
y<- c(4,5,6)
plot(x,y)
hist(x)
boxplot(x)
hist(x,binwidth=5)
hist(x,bins=5)
x<- c(1,2,3)
y<- c(4,5,6)
plot(x,y)
hist(x)
boxplot(x)
x<- 5
if(x>0) {
print("x is positive")
} else {
print("x is negative")
}
x<- c(1,2,3)
y<- c(4,5,6)
plot(x,y)
hist(x)
day<- 3
result<- switch(day,
"1"="Monday",
"2"="Tuesday",
"3"="Wednesday",
"4"="Thursday",
"5"="Friday",
"6"="Saturday",
"7"="Sunday")
print(result)
day<- 3
result<- switch(day,
"1"="Monday",
"2"="Tuesday",
"3"="Wednesday",
"4"="Thursday",
"5"="Friday",
"Weekend")
print(result)
print("Hello, [Richie]!")
a<-15
b<-5
print(a+b)
print(a-b)
print(a*b)
print(a/b)
boxplot(x)
a<-15
b<-5
sum<-a+b
print(sum)
print(a-b)
print(a*b)
print(a/b)
print(paste("Sum: ",sum))
a<-15
b<-5
sum<-a+b
print(sum)
print(a-b)
print(a*b)
print(a/b)
print(paste("Sum : ",sum))
a<-15
b<-5
sum<-a+b
print(sum)
print(a-b)
print(a*b)
print(a/b)
print(paste("Sum :",sum))
numbers<- c(10,20,30,40,50,60,70)
sum<- sum(numbers)
mean<- mean(numbers)
max<- max(numbers)
print(paste("Max :",max))
x <- c(1,2,3,4,5)
y <- c(2,4,6,8,10)
plot(x,y,type="o",col="blue",
main="Line Plot",
xlab="X-Axis",
ylab="Y-Axis")
matrix(1:9,3,3)
matrix(1:9,3,3,byRow=TRUE)
matrix(1:9,3,3,byrow=TRUE)
x <- c(1,2,3,4,5)
y <- c(5,4,3,2,1)
sum <- x+y
diff <- x-y
prod <- x*y
quot <- x/y
print(paste("Prod :",prod))
print(prod)
print(quot)
print(a/b)
a<-13
b<-5
sum<-a+b
print(sum)
print(a-b)
print(a*b)
print(a/b)
x <- c(1,2,3,4,5)
y <- c(5,4,3,2,1)
sum <- x+y
diff <- x-y
prod <- x*y
quot <- x/y
print(prod)
print(quot)
install.packages("maps")
library(maps)
library(maps)
library(ggplot2)
world_map <- map_data("world")
ggplot(world_map,aes(x=long,y=lat,group=group))+
geom_polygon(fill="lightgray",color="black")+
ggtitle("World Map using ggplot2")
world_map <- map_data("world")
ggplot(world_map,aes(x=long,y=lat,group=group))+
geom_polygon(fill="lightgray",color="black")+
ggtitle("World Map using ggplot2")
world_map <- map_data("world")
ggplot(world_map,aes(x=long,y=lat,group=group))+
+   geom_polygon(fill="lightgray",color="black")+
+   ggtitle("World Map using ggplot2")
world_map <- map_data("world")
ggplot(world_map,aes(x=long,y=lat,group=group))+
geom_polygon(fill="lightgray",color="black")+
ggtitle("World Map using ggplot2")
iris
head(iris)
head(iris)
tail(iris)
table(iris$Species)
hist(iris$Sepal.Width)
barplot(iris$Sepal.Width)
pie(table(iris$Sepal.Length))
pie(table(iris$Sepal.Width))
boxplot(iris$Sepal.Length~iris$Species,
xlab="Species",ylab="Speal Length",col="blue")
library(scatterplot3d)
boxplot(iris$Petal.Length~irs$Sepal.Length,xlab="Petal",
main="Petal Legnth vs Sepal Length",col="green")
library(scatterplot3d)
boxplot(iris$Petal.Length~iris$Sepal.Length,xlab="Petal",
main="Petal Legnth vs Sepal Length",col="green")
boxplot(iris$Sepal.Length~iris$Species,
xlab="Species",ylab="Sepal Length",col="blue")
library(scatterplot3d)
boxplot(iris$Petal.Length~iris$Sepal.Length,xlab="Petal Length",ylab="Sepal Length",
main="Petal Legnth vs Sepal Length",col="green")
install.packages("scatterplot3d")
install.packages("scatterplot3d")
library(scatterplot3d)
boxplot(iris$Petal.Length~iris$Sepal.Length,xlab="Petal Length",ylab="Sepal Length",
main="Petal Legnth vs Sepal Length",col="green")
